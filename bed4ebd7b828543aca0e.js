(window.webpackJsonp=window.webpackJsonp||[]).push([[115],{1755:function(t,n,e){"use strict";var o=e(606);e.n(o).a},1756:function(t,n,e){(t.exports=e(5)(!1)).push([t.i,".user-index .aff-link{cursor:pointer}.user-index .nya-loading{margin:2.5rem auto}",""])},1901:function(t,n,e){"use strict";e.r(n);e(31);var o=e(52),r=e.n(o),c={name:"UserIndex",head:function(){return{titleTemplate:"用户中心 - %s"}},data:function(){return{data:{},cardKey:"",cardLoading:!1,transformAffLoading:!1}},watch:{"$store.state.user":function(t){t.id||this.$router.replace("/")}},mounted:function(){var t=this;setTimeout((function(){var n=t.$store.state,e=n.user,o=n.verify;!e.id&&o?(t.$noty.error("请先登录"),t.$router.replace("/")):t.getInfo()}),0)},methods:{logout:function(){var t=this;this.$store.state.user.id&&this.$swal({title:"已登录，是否退出登录",type:"warning",showCancelButton:!0,confirmButtonText:"退出"}).then((function(n){n.value&&(t.$router.replace("/"),t.$store.commit("SET_STORE",{key:"user",value:{id:"",token:""}}),t.$noty.success("退出成功"))}))},getInfo:function(){var t=this;this.$axios.post("/user/info").then((function(n){t.data=n.data.data})).catch((function(n){t.$noty.error("获取用户信息失败：".concat(n))}))},formatDate:function(t){return r()(t).format("YYYY-MM-DD")},activateCard:function(){var t=this;return!this.cardLoading&&(!!this.cardKey&&(this.cardLoading=!0,void this.$axios.post("/user/vip",{key:this.cardKey}).then((function(){t.cardLoading=!1,t.$noty.success("激活成功，感谢您的支持"),t.getInfo()})).catch((function(n){t.cardLoading=!1,t.$noty.error("激活失败：".concat(n))}))))},transformAff:function(){var t=this,n=Math.floor((this.data.aff-this.data.transform_aff)/5);return n<1?this.$swal({type:"error",title:"兑换失败",text:"可兑换人数不足5人，无法兑换"}):!this.transformAffLoading&&void this.$swal.fire({title:"预计可转换为".concat(n,"个月VIP"),text:"是否继续",type:"warning",showCancelButton:!0,confirmButtonText:"确认转换"}).then((function(n){n.value&&(t.transformAffLoading=!0,t.$axios.post("/user/transform_aff").then((function(n){t.transformAffLoading=!1,t.$noty.success("转换成功，获得".concat(n.data.data,"个月VIP")),t.getInfo()})).catch((function(n){t.transformAffLoading=!1,t.$noty.error("转换失败：".concat(n))})))}))},copy:function(text){var t=this;this.$copyText(text).then((function(){t.$noty.success("复制成功")}),(function(){t.$noty.error("复制失败，可手动进行复制")}))}}},f=(e(1755),e(3)),component=Object(f.a)(c,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"user-index"},[e("nya-container",{attrs:{title:"用户中心"}},[t.data.mail?e("div",{staticClass:"content"},[e("p",[e("b",[t._v("注册时间：")]),t._v(t._s(t.formatDate(t.data.unix)))]),t._v(" "),e("p",[e("b",[t._v("ID：")]),e("span",[t._v(t._s(t.data.id))])]),t._v(" "),e("p",[e("b",[t._v("邮箱：")]),e("span",[t._v(t._s(t.data.mail))])]),t._v(" "),e("p",[e("b",[t._v("VIP到期时间：")]),t._v(t._s(t.data.vip?t.formatDate(t.data.vip):"未开通")+"\n            ")]),t._v(" "),e("p",[e("b",[t._v("邀请人数 "),e("button",{staticClass:"nya-btn is-smail",attrs:{title:"每邀请5名用户可转换为1个月VIP会员",type:"button",disabled:t.transformAffLoading},on:{click:t.transformAff}},[t._v("\n                    "+t._s(t.transformAffLoading?"转换中":"转换为VIP")+"\n                ")]),t._v("：\n                ")]),t._v("共邀请了\n                "),e("b",{staticClass:"nya-c-theme"},[t._v(t._s(t.data.aff))]),t._v("\n                人，剩余可兑换VIP人数："),e("b",{staticClass:"nya-c-theme"},[t._v(t._s(t.data.aff-t.data.transform_aff))])]),t._v(" "),e("p",[e("b",[t._v("邀请链接：")]),e("b",{staticClass:"aff-link nya-c-theme",attrs:{title:"点击复制"},on:{click:function(n){return t.copy("https://tools.imiku.me/?aff="+t.data.id+"&ref=aff")}}},[t._v(t._s("https://tools.imiku.me/?aff="+t.data.id+"&ref=aff"))])]),t._v(" "),e("hr"),t._v(" "),e("p",[t._v("你可以通过"),e("b",[t._v(" 邀请用户注册 ")]),t._v("或"),e("b",[t._v(" 充值 ")]),t._v(" 成为本站VIP")]),t._v(" "),e("div",{staticClass:"inputbtn mb-15"},[e("nya-input",{attrs:{autofocus:"",label:"输入 VIP 卡密激活 <a href='https://card.mikutools.dio.cx' target='_blank' rel='noopener noreferrer'>点击购买卡密</a>",autocomplete:"off"},on:{keyup:function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"enter",13,n.key,"Enter")?null:t.activateCard(n)}},model:{value:t.cardKey,callback:function(n){t.cardKey="string"==typeof n?n.trim():n},expression:"cardKey"}}),t._v(" "),e("button",{staticClass:"nya-btn",attrs:{type:"button",disabled:t.cardLoading},on:{click:t.activateCard}},[t._v("\n                    "+t._s(t.cardLoading?"激活中":"激活卡密")+"\n                ")])],1)]):t._e(),t._v(" "),t.$store.state.user.token?e("div",{staticClass:"nya-btn",on:{click:t.logout}},[t._v("\n            退出登陆\n        ")]):e("nya-loading")],1)],1)}),[],!1,null,null,null);n.default=component.exports},606:function(t,n,e){var content=e(1756);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,e(6).default)("a282b73a",content,!0,{sourceMap:!1})}}]);